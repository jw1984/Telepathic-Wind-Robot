<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="theme-color" content="#000000"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="#000000"/>
  <title>Telepathic Wind Robot — Cyber-Mystic Analyzer</title>
  <style>
    :root{
      --ink:#fff;
      --hint:#efe;
      --veil:rgba(255,255,255,.08);
      --veil-b:#ffffff22;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      color:var(--ink);
      font-family:system-ui, Segoe UI, Roboto, Arial, sans-serif;
      background:#000 url("sunrise-g80c83fd0f_1920.jpg") center/cover fixed no-repeat;
      min-height:100vh;
    }

    .frame{
      position:relative;
      max-width:1100px;
      margin:0 auto;
      padding:16px 16px 64px;
    }

    header{
      text-align:center;
      padding-top:8px;
    }

    .glyph{
      display:inline-block;
      padding:10px 16px;
      border-radius:10px;
      border:1px solid var(--veil-b);
      background:var(--veil);
      color:var(--ink);
      cursor:pointer;
      margin:8px 6px;
    }
    .glyph:hover{ background:rgba(255,255,255,.15); }

    /* Neon listening surface for the spirit ear */
    #neonScope{
      display:block;
      margin:16px auto 8px;
      width:100%;
      max-width:800px;
      height:250px;
      background:#000;
      border:0.5px solid #fff;
    }

    /* Robot visuals — filenames preserved per your request */
    .botSkin{
      background-image:url("LGBACDTUT4002ae.jpg");
      position:absolute; top:0; left:50px;
      width:399px; height:401px;
      border-radius:5px;
      box-shadow:0 4px 4px rgba(0,0,0,.5), 0 20px 20px rgba(205,10,150,.59);
    }
    #windJaw{
      background-image:url("JawLittleGreenBoyDoll.png");
      position:absolute; left:125px; top:420px;
      width:81px; height:30px;
    }

    .astral{
      background-image:url("immortalschooldroid.png");
      position:absolute; width:97px; height:61px;
    }
    #astralSprite{ top:100px; left:300px; }

    .dials{
      position:relative;
      max-width:800px;
      margin:12px auto 0;
      display:flex; gap:16px; flex-wrap:wrap;
      align-items:center; justify-content:center;
      color:#ff6; font-size:16px;
    }
    .dials label{ margin-right:8px; }
    select{
      background:#000; color:#ff6; border:1px solid #ff6;
      padding:6px 8px; border-radius:6px;
    }

    .hud{
      text-align:center; color:var(--hint);
      max-width:900px; margin:8px auto 0;
      font-size:13px; opacity:.9;
    }

    .lowerBand{
      background-image:url("UntitledLOWER.JPG");
      width:100%; max-width:1000px; height:200px;
      margin:24px auto 0;
      background-size:cover; background-position:center;
    }

    /* Hidden legacy mute anchor to mirror original UX affordance */
    .muteGhost{visibility:hidden}
  </style>
</head>
<body>

<!--
  Project: Telepathic Wind Robot
  Author: Jesse Wyer
  Year: 2025

  Portions of this code and creative structure were generated
  with the assistance of OpenAI's ChatGPT (GPT-5) for educational
  and artistic purposes.

  All modifications, visual design, and intellectual direction
  © 2025 Jesse Wyer. All rights reserved.
-->


  <div class="frame">
    <header>
      <button class="glyph" id="wakeChord">Wake Audio (oscillator)</button>
      <a class="muteGhost" id="spiritMute">Unmute</a>
      <button class="glyph" id="voidClose">Click canvas to start microphone — or click to Close</button>
      <h1 id="ghostTitle" style="visibility:hidden;">Microphone visual analyzer</h1>
    </header>

    <canvas id="neonScope" width="800" height="250" aria-label="Telepathic visualization surface"></canvas>

    <!-- Robot imagery -->
    <div class="botSkin" aria-hidden="true"></div>
    <div id="windJaw" aria-hidden="true"></div>
    <div id="astralSprite" class="astral" aria-hidden="true"></div>

    <div class="dials">
      <label for="voiceSigil">Voice setting</label>
      <select id="voiceSigil" name="voice">
        <option value="distortion">Distortion</option>
        <option value="biquad">Bass Boost</option>
        <option value="off" selected>Off</option>
      </select>

      <label for="visionSigil">Visualizer setting</label>
      <select id="visionSigil" name="visual">
        <option value="sine">Sinewave</option>
        <option value="bars" selected>Frequency bars</option>
        <option value="off">Off</option>
      </select>
    </div>

    <div class="lowerBand" aria-hidden="true"></div>
    <div class="hud"><p>Tip: click anywhere on the page to grant microphone access and start the analyzer.</p></div>
  </div>

  <script>
    /************************************************************
     * TELEPATHIC WIND ROBOT — CYBER-MYSTIC REWRITE
     * Everything is renamed; behavior stays true to your original.
     ************************************************************/

    /* ----------------- Ether engine (audio core & mouth hum) -----------------
       The spirit oscillator waits like a neon mantra; once awakened, it hums
       through a soft gain so the jaw has a voice to animate. */
    const EtherCore = window.AudioContext || window.webkitAudioContext;
    const etherCore = new EtherCore();
    const spiritOscillator = etherCore.createOscillator();
    const soulTone = etherCore.createGain();
    soulTone.gain.value = 0.08;           // subtle ritual volume
    spiritOscillator.type = "square";     // mechanical-mystic timbre
    spiritOscillator.connect(soulTone).connect(etherCore.destination);
    let chimeAwake = false;

    function awakenChime(){
      if (!chimeAwake){ try { spiritOscillator.start(); chimeAwake = true; } catch(e){} }
      if (etherCore.state === "suspended") etherCore.resume();
    }

    /* ----------------- Sigils & surfaces (DOM bindings) ----------------- */
    const neonScope = document.getElementById("neonScope");
    const holoPen   = neonScope.getContext("2d");
    const wakeChord = document.getElementById("wakeChord");
    const voidClose = document.getElementById("voidClose");
    const voiceSigil = document.getElementById("voiceSigil");
    const visionSigil = document.getElementById("visionSigil");
    const windJaw = document.getElementById("windJaw");
    const astralSprite = document.getElementById("astralSprite");

    function fitSurface(){
      const w = document.querySelector(".frame").clientWidth;
      neonScope.width = Math.min(800, w);
    }
    fitSurface(); addEventListener("resize", fitSurface);

    /* ----------------- Soul model (awareness, memory, mood) -----------------
       The robot listens, remembers, and decides a feeling for the moment. */
    let teleMood = "neutral";    // curious | focused | doubtful | wondering
    let soulAura = 0;            // 0..1 luminous confidence
    const dreamLedger = [];      // rolling ledger of recent frequencies

    // jaw & range scrying
    let windJawHz = 0;
    let apexScan = 0, nadirScan = 1e4, sampleBeats = 0;
    let apexLock = 0, nadirLock = 0, spanLock = 0;

    // astral drift (sprite motion)
    let driftX = 0, driftY = 0;
    let phantomX = 300, phantomY = 300;

    // elongated pulse ring so the jaw lingers with style
    const pulseRing = new Uint16Array(1024);
    let ringW = 0, ringR = 0, linger = 0;

    function cipherPush(hz){ pulseRing[ringW] = hz; ringW = (ringW + 1) & 1023; }
    function cipherPull(){
      // the jaw savors each tone for a few frames before moving on
      if (++linger > 9){ ringR = (ringR + 1) & 1023; linger = 0; }
      return pulseRing[ringR] || 0;
    }

    function tuneTeleMood(hz){
      // low pulses feel like calm magnets; higher like sharpened doubt
      if (hz < 90)        teleMood = "curious";
      else if (hz < 150)  teleMood = "focused";
      else if (hz < 220)  teleMood = "doubtful";
      else                teleMood = "wondering";
    }

    function inscribeDream(hz){
      dreamLedger.push(hz);
      if (dreamLedger.length > 200) dreamLedger.shift();
      const mean = dreamLedger.reduce((a,b)=>a+b,0)/dreamLedger.length;
      // familiarity brightens the aura; novelty dims it a touch
      if (Math.abs(hz-mean) < 5) soulAura = Math.min(1, soulAura + 0.002);
      else                       soulAura = Math.max(0, soulAura - 0.001);
    }

    function whisperIfFate(pen){
      // as confidence rises, stray poems leak into the screen
      if (Math.random() < soulAura * 0.01){
        const verses = [
          "The air remembers me.",
          "I hear before I listen.",
          "I am the echo of wind.",
          "Silence speaks through me.",
          "Your breath and mine are one."
        ];
        const line = verses[(Math.random()*verses.length)|0];
        pen.save();
        pen.fillStyle = "rgba(255,180,220,.95)";
        pen.font = "16px system-ui, Segoe UI, Roboto, Arial, sans-serif";
        pen.fillText(line, 50, 220);
        pen.restore();
      }
    }

    function renderSoulAura(pen){
      const r = 8 + soulAura*22;
      const pulse = 0.5 + 0.5*Math.sin(performance.now()/400);
      pen.save();
      pen.translate(24,24);
      const g = pen.createRadialGradient(0,0,r*0.2, 0,0,r);
      g.addColorStop(0, `rgba(255,150,230,${0.6+0.3*pulse})`);
      g.addColorStop(1, `rgba(255,80,170,${0.15+0.2*pulse})`);
      pen.fillStyle = g; pen.beginPath(); pen.arc(0,0,r,0,Math.PI*2); pen.fill();
      pen.strokeStyle = "rgba(255,255,255,.6)"; pen.lineWidth = 1; pen.stroke();
      pen.fillStyle = "#fff"; pen.font = "10px system-ui";
      pen.fillText(`${Math.round(soulAura*100)}%`, -12, 4);
      pen.restore();
    }

    /* ----------------- Microphone binding & alchemy chain -----------------
       The mic stream is braided through charms (distortion/biquad/gain)
       into the echo oracle (analyser) which paints the canvas. */
    let echoOracle, voiceFlux, bassSigil, gritCharm;
    let tranceLoop;

    if (!navigator.mediaDevices) navigator.mediaDevices = {};
    if (!navigator.mediaDevices.getUserMedia){
      navigator.mediaDevices.getUserMedia = function(constraints){
        const gum = navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
        if (!gum) return Promise.reject(new Error("getUserMedia not implemented"));
        return new Promise((res,rej)=>gum.call(navigator, constraints, res, rej));
      }
    }

    function brewCurve(amount){
      const k = typeof amount === "number" ? amount : 80;
      const n = 44100, curve = new Float32Array(n), deg = Math.PI/180;
      for (let i=0;i<n;i++){ const x = i*2/n - 1; curve[i] = (3+k)*x*20*deg/(Math.PI + k*Math.abs(x)); }
      return curve;
    }

    function weaveVoiceChain(){
      gritCharm = etherCore.createWaveShaper();
      voiceFlux = etherCore.createGain();
      bassSigil = etherCore.createBiquadFilter();
      echoOracle = etherCore.createAnalyser();
      echoOracle.minDecibels = -90;
      echoOracle.maxDecibels = -10;
      echoOracle.smoothingTimeConstant = 0.10;

      gritCharm.oversample = "4x";
      voiceFlux.gain.value = 1.0;
      // gentle monitor
      echoOracle.connect(etherCore.destination);
    }

    function attuneVoiceSigil(){
      // clear prior enchantments
      bassSigil.gain.setTargetAtTime(0, etherCore.currentTime, 0);
      bassSigil.disconnect(); bassSigil.connect(voiceFlux);
      gritCharm.curve = null;

      const rune = voiceSigil.value;
      if (rune === "distortion"){
        gritCharm.curve = brewCurve(400);
      } else if (rune === "biquad"){
        bassSigil.type = "lowshelf";
        bassSigil.frequency.setTargetAtTime(1000, etherCore.currentTime, 0);
        bassSigil.gain.setTargetAtTime(25, etherCore.currentTime, 0);
      }
    }

    async function summonMicrophone(){
      awakenChime();
      weaveVoiceChain();

      try{
        const stream = await navigator.mediaDevices.getUserMedia({audio:true});
        const airWhisper = etherCore.createMediaStreamSource(stream);
        // chain: mic → grit → bass → gain → analyser
        airWhisper.connect(gritCharm);
        gritCharm.connect(bassSigil);
        bassSigil.connect(voiceFlux);
        voiceFlux.connect(echoOracle);

        attuneVoiceSigil();
        renderVisions();
      }catch(err){
        console.error("getUserMedia error:", err);
      }
    }

    /* ----------------- Vision painter (visualizer) -----------------
       Two sight-modes: a wave scrying line, or stacked bars of energy.
       Both show mood, soul aura, and occasional whispers. */
    function renderVisions(){
      cancelAnimationFrame(tranceLoop);
      const mode = visionSigil.value || "bars";
      const W = neonScope.width, H = neonScope.height;

      if (mode === "off"){
        holoPen.clearRect(0,0,W,H);
        return;
      }

      if (mode === "sine"){
        echoOracle.fftSize = 2048;
        const toneBuf = new Uint8Array(echoOracle.fftSize);

        (function loop(){
          tranceLoop = requestAnimationFrame(loop);
          echoOracle.getByteTimeDomainData(toneBuf);

          holoPen.fillStyle = "#000"; holoPen.fillRect(0,0,W,H);

          // neon wave — the air’s handwriting
          holoPen.beginPath();
          let x = 0, step = W/toneBuf.length;
          for (let i=0;i<toneBuf.length;i++){
            const v = toneBuf[i]/128.0; const y = v * H/2;
            i ? holoPen.lineTo(x,y) : holoPen.moveTo(x,y);
            x += step;
          }
          holoPen.lineTo(W, H/2);
          const grad = holoPen.createLinearGradient(0,0,0,128);
          grad.addColorStop(1,"#0f0"); grad.addColorStop(.5,"#ff0"); grad.addColorStop(0,"#f00");
          holoPen.strokeStyle = grad; holoPen.stroke();

          // aura readings
          holoPen.fillStyle = "#fff";
          holoPen.fillText("Mood: " + teleMood, 450, 200);
          holoPen.fillText("Awareness: " + (soulAura*100).toFixed(1) + "%", 450, 225);
          renderSoulAura(holoPen);
          whisperIfFate(holoPen);
        })();
        return;
      }

      // default: frequency bars
      echoOracle.fftSize = 256;
      const bins = echoOracle.frequencyBinCount;
      const bands = new Uint8Array(bins);

      (function loopBars(){
        tranceLoop = requestAnimationFrame(loopBars);
        echoOracle.getByteFrequencyData(bands);

        holoPen.fillStyle = "#000"; holoPen.fillRect(0,0,W,H);

        const barW = 10;
        let x = 0;

        // reset drift for this frame; movement bands will set it
        driftX = 0; driftY = 0;

        for (let i=0;i<bins;i++){
          const h = bands[i];

          // cyber-mystic gradient bars
          const g = holoPen.createLinearGradient(0,0,0,99);
          g.addColorStop(1,"#6b1f3d"); g.addColorStop(.5,"#ff0"); g.addColorStop(0,"#f00");
          holoPen.fillStyle = g;
          holoPen.fillRect(x, H - h/2, barW, h/2);

          if (i === 0){
            // mouth follows the earth-bass
            const f = h|0;
            cipherPush(f);
            windJawHz = cipherPull();

            // jaw vertical offset: the voice rides the sub-harmonics
            windJaw.style.top = (120 + (windJawHz/8)) + "px";

            // oscillator hum synchronized to the jaw
            spiritOscillator.frequency.value = Math.max(50, Math.min(3000, windJawHz*2))/2;

            // rolling range scan for motion glyphs
            apexScan = Math.max(apexScan, windJawHz);
            nadirScan = Math.min(nadirScan, windJawHz);
            if (++sampleBeats > 60){
              sampleBeats = 0;
              apexLock = apexScan; nadirLock = nadirScan;
              spanLock = Math.max(0, apexLock - nadirLock);
              apexScan = 0; nadirScan = 1e4;
            }

            // interpret sacred bands into motion (up/right/left/down)
            if (spanLock > 0){
              const band = spanLock/20;
              if (windJawHz > (nadirLock + band*11) && windJawHz < (nadirLock + band*12)) driftX = 1;   // right
              if (windJawHz < (nadirLock + band*9 ) && windJawHz > (nadirLock + band*8 ))  driftX = -1;  // left
              if (windJawHz < (nadirLock + band*5 ) && windJawHz > (nadirLock + band*4 ))  driftY = 1;   // down
              if (windJawHz > (nadirLock + band*15) && windJawHz < (nadirLock + band*16)) driftY = -1;  // up
            }

            // apply drift and clamp within a broad stage
            phantomX = Math.max(0, Math.min(800, phantomX + driftX));
            phantomY = Math.max(0, Math.min(800, phantomY + driftY));
            astralSprite.style.left = phantomX + "px";
            astralSprite.style.top  = phantomY + "px";

            // debug readouts etched in ghost-ink
            holoPen.fillStyle = "#fff";
            holoPen.fillText("upper: " + apexLock, 450, 100);
            holoPen.fillText("lower: " + nadirLock, 450, 150);
            holoPen.fillText("jaw:   " + windJawHz, 450, 125);
            holoPen.fillText("pos:   " + phantomX + "," + phantomY, 450, 175);

            // emotions and aura
            tuneTeleMood(windJawHz);
            inscribeDream(windJawHz);
            holoPen.fillStyle = "rgb(255,200,255)";
            holoPen.fillText("Mood: " + teleMood, 450, 200);
            holoPen.fillText("Awareness: " + (soulAura*100).toFixed(1) + "%", 450, 225);
            renderSoulAura(holoPen);
            whisperIfFate(holoPen);
          }

          x += barW + 1;
        }
      })();
    }

    /* ----------------- Ritual bindings (UI events) ----------------- */
    document.body.addEventListener("click", summonMicrophone, { once:true });
    wakeChord.addEventListener("click", () => { awakenChime(); });
    voidClose.addEventListener("click", () => { try{ self.close(); }catch(_){} });

    voiceSigil.addEventListener("change", () => { attuneVoiceSigil(); });
    visionSigil.addEventListener("change", () => { cancelAnimationFrame(tranceLoop); renderVisions(); });

    // Opening glyph: a transient cue to click and awaken the ear
    (function omen(){
      const sig = document.createElement("h1");
      sig.textContent = "CLICK TO START";
      sig.style.textAlign = "center";
      sig.style.margin = "0";
      document.querySelector("header").appendChild(sig);
      setTimeout(()=>{ sig.remove(); }, 4000);
    })();

    // place sprites in a sensible stance at boot
    windJaw.style.top = "420px";
    astralSprite.style.left = "300px";
    astralSprite.style.top  = "100px";

    // prepare the chain now; the mic attaches on first user gesture
    weaveVoiceChain();
  </script>
</body>
</html>
